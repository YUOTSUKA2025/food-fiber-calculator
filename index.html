<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>食物繊維計算機</title>
<style>
    body {
        font-family: sans-serif;
        padding: 10px;
        max-width: 500px;
        margin: auto;
    }
    h1 {
        font-size: 1.5em;
        text-align: center;
    }
    .input-container {
        position: relative;
        margin-bottom: 10px;
    }
    input {
        width: 100%;
        padding: 8px;
        font-size: 1em;
        box-sizing: border-box;
    }
    .suggestions {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: white;
        border: 1px solid #ccc;
        max-height: 200px;
        overflow-y: auto;
        display: none;
        z-index: 1000;
    }
    .suggestions div {
        padding: 8px;
        cursor: pointer;
    }
    .suggestions div:hover {
        background: #eee;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
    }
    th, td {
        border: 1px solid #ccc;
        padding: 6px;
        text-align: center;
        font-size: 0.9em;
    }
    button {
        padding: 5px 10px;
        font-size: 0.9em;
        cursor: pointer;
    }
</style>
</head>
<body>
<h1>食物繊維計算機</h1>

<div class="input-container">
    <input type="text" id="foodInput" placeholder="食材名を入力">
    <div id="suggestions" class="suggestions"></div>
</div>
<div>
    <input type="number" id="amountInput" placeholder="重量 (g)">
</div>
<button id="addBtn">追加</button>

<table id="fiberTable">
    <thead>
        <tr>
            <th>食材名</th>
            <th>重量(g)</th>
            <th>食物繊維量(g)</th>
            <th>削除</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<h2>合計食物繊維量: <span id="totalFiber">0</span> g</h2>

<p style="font-size:0.8em;color:gray;">
※ 食物繊維量は100gあたりの目安です。実際の含有量は品種・調理方法で変わります。
</p>

<script>
const foods = {
    "玄米": 3.0, "納豆": 6.7, "豆腐": 0.3, "わかめ": 3.6, "ごぼう": 5.7,
    "にんじん": 2.8, "キャベツ": 1.8, "ブロッコリー": 4.4, "レタス": 1.1,
    "トマト": 1.0, "大根": 1.4, "ほうれん草": 2.8, "小松菜": 1.9,
    "しいたけ": 4.2, "えのき": 3.6, "しめじ": 3.3, "マイタケ": 2.7,
    "りんご": 1.9, "みかん": 1.9, "バナナ": 1.1, "いちご": 1.4,
    "サツマイモ": 2.3, "じゃがいも": 1.3, "カボチャ": 2.8, "枝豆": 5.0,
    "黒豆": 16.0, "ひじき": 43.3, "昆布": 27.1, "春雨": 0.1,
    "オートミール": 9.4, "キムチ": 2.7, "ザーサイ": 1.8,
    "チャーハン": 1.5, "ビビンバ": 2.2, "パスタ": 1.8, "ピザ": 2.0,
    "サラダチキン": 0, "鶏肉": 0, "豚肉": 0, "牛肉": 0,
    "サーモン": 0, "マグロ": 0, "イカ": 0, "タコ": 0, "エビ": 0,
    "サバ": 0, "イワシ": 0, "アジ": 0, "ホッケ": 0
};

const foodInput = document.getElementById("foodInput");
const suggestions = document.getElementById("suggestions");
const amountInput = document.getElementById("amountInput");
const tableBody = document.querySelector("#fiberTable tbody");
const totalFiberEl = document.getElementById("totalFiber");

foodInput.addEventListener("focus", showSuggestions);
foodInput.addEventListener("input", showSuggestions);
document.addEventListener("click", (e) => {
    if (!e.target.closest(".input-container")) {
        suggestions.style.display = "none";
    }
});

function showSuggestions() {
    const query = foodInput.value.trim();
    suggestions.innerHTML = "";
    const filtered = Object.keys(foods).filter(f => f.includes(query));
    filtered.forEach(food => {
        const div = document.createElement("div");
        div.textContent = food;
        div.addEventListener("click", () => {
            foodInput.value = food;
            suggestions.style.display = "none";
        });
        suggestions.appendChild(div);
    });
    suggestions.style.display = filtered.length ? "block" : "none";
}

document.getElementById("addBtn").addEventListener("click", () => {
    const food = foodInput.value.trim();
    const amount = parseFloat(amountInput.value);
    if (!foods[food]) {
        alert("候補から食材を選んでください");
        return;
    }
    if (isNaN(amount) || amount <= 0) {
        alert("重量を入力してください");
        return;
    }
    const fiberPer100g = foods[food];
    const fiber = (fiberPer100g * amount / 100).toFixed(2);

    const row = document.createElement("tr");
    row.innerHTML = `
        <td>${food}</td>
        <td>${amount}</td>
        <td>${fiber}</td>
        <td><button>削除</button></td>
    `;
    row.querySelector("button").addEventListener("click", () => {
        row.remove();
        updateTotal();
    });

    tableBody.appendChild(row);
    updateTotal();
    foodInput.value = "";
    amountInput.value = "";
});

function updateTotal() {
    let total = 0;
    document.querySelectorAll("#fiberTable tbody tr").forEach(row => {
        total += parseFloat(row.cells[2].textContent);
    });
    totalFiberEl.textContent = total.toFixed(2);
}
</script>
</body>
</html>
